cscope 15 $HOME/code/cplusplus/hdp-zl               0000018164
	@corpus.cc

	@corpus.h

	@document.cc

1 
	~<m©h.h
>

2 
	~<as£¹.h
>

4 
	~"docum’t.h
"

5 
	~"uts.h
"

7 
Çme¥aû
 
	ghdp
 {

13 
	gWÜd
::
WÜd
(
id
)

14 : 
id_
(
id
) {

18 
WÜd
::~Word() {}

24 
WÜdUts
::
Upd©eTabËFromWÜd
(
WÜd
* 
wÜd
,

25 
upd©e
) {

26 
TabË
* 
	gbË
 = 
wÜd
->
g‘MubËTabË
();

27 
	gbË
->
šcWÜdCouÁ
(
upd©e
);

28 
	gbË
->
upd©eM­WÜdCouÁ
(
wÜd
->
g‘Id
(), 
upd©e
);

31 
	gTabËUts
::
Upd©eTİic
(
bË
, 
wÜd
->
g‘Id
(), 
upd©e
);

38 
	gTabË
::
TabË
()

39 : 
wÜd_couÁ_
(0) {

40 
tİic_
 = 
NULL
;

43 
	gTabË
::
TabË
(
wÜd_couÁ
)

44 : 
wÜd_couÁ_
(
wÜd_couÁ
) {

45 
tİic_
 = 
NULL
;

50 
	gTabË
::
g‘CouÁById
(
wÜd_id
) {

51 autØ
™
 = 
m­_wÜd_couÁ_
.
fšd
(
wÜd_id
);

52 ià(
	g™
 =ğ
wÜd_id
.
’d
()) {

55  
	gm­_wÜd_couÁ_
[
wÜd_id
];

59 
upd©eM­WÜdCouÁ
(
wÜd_id
, 
upd©e
) {

60 autØ
	g™
 = 
m­_wÜd_couÁ_
.
fšd
(
wÜd_id
);

61 ià(
	g™
 =ğ
wÜd_id
.
’d
()) {

62 
m­_wÜd_couÁ_
[
wÜd_id
] = 
upd©e
;

64 
	gm­_wÜd_couÁ_
[
wÜd_id
] +ğ
upd©e
;

66 
as£¹
(
m­_wÜd_couÁ_
[
wÜd_id
] >= 0);

67 ià(
	gm­_wÜd_couÁ_
[
wÜd_id
] == 0) {

68 
m­_wÜd_couÁ_
.
”a£
(
wÜd_id
);

78 
	gTabËUts
::
G‘WÜdsAndCouÁs
(
TabË
* 
bË
,

79 
veùÜ
<>& 
wÜd_ids
,

80 
veùÜ
<>& 
couÁs
) {

81 
	gunÜd”ed_m­
<, >& 
	gm
 = 
bË
->
g‘M­WÜdCouÁ
();

82 
	gsize
 = 
m
.
size
();

84 
	gwÜd_ids
.
»£rve
(
size
);

85 
	gcouÁs
.
»£rve
(
size
);

87 autØ
	gp
 : 
m
) {

88 
wÜd_ids
.
push
(
p
.
fœ¡
);

89 
	gcouÁs
.
push
(
p
.
£cÚd
);

93 
	gTabËUts
::
Upd©eTİic
(
TabË
* 
bË
,

94 
wÜd_id
,

95 
upd©e
) {

96 
Tİic
* 
	gtİic
 = 
bË
->
g‘MubËTİic
();

97 
	gtİic
->
upd©eWÜdCouÁs
(
wÜd_id
, 
upd©e
);

100 
	gTabËUts
::
Upd©eTİicFromTabË
(
TabË
* 
bË
,

101 
veùÜ
<>& 
wÜd_ids
,

102 
veùÜ
<>& 
couÁs
,

103 
upd©e
) {

105 
	gsize
 = 
wÜd_ids
.
size
();

107 
	gi
 = 0; i < 
	gsize
; i++) {

108 
	gwÜd_id
 = 
wÜd_ids
[
i
];

109 
Upd©eTİic
(
bË
, 
wÜd_id
, 
upd©e
 * 
couÁs
[word_id]);

112 
	gbË
->
G‘aMubËTİic
()->
šcTabËCouÁ
(
upd©e
);

115 
	gTabËUts
::
Sam¶eTİicFÜTabË
(
TabË
* 
bË
,

116 
gamma
) {

117 
	gAÎTİics
& 
	g®l_tİics
 = 
AÎTİics
::
G‘In¡ªû
();

118 
	gtİics
 = 
®l_tİics
.
g‘Tİics
();

120 
	gveùÜ
<> 
	gwÜd_ids
;

121 
	gveùÜ
<> 
	gcouÁs
;

122 
	gTabËUts
::
G‘WÜdsAndCouÁs
(
bË
, 
wÜd_ids
, 
couÁs
);

124 
as£¹
(
tİics
 >= 1);

125 
	gcÜpus_wÜd_no
 = 
®l_tİics
.
g‘MubËTİic
[0]->
g‘CÜpusWÜdNo
();

126 
	g®l_tİics
.
addNewTİic
(
cÜpus_wÜd_no
);

128 
	gveùÜ
<> 
log_´
(
tİics
 + 1, 0.0);

129 
	gi
 = 0; i < 
	gtİics
; i++) {

130 
Tİic
* 
	gtİic
 = 
®l_tİics
.
g‘MubËTİic
(
i
);

131 ià(
	gbË
->
g‘MubËTİic
(è!ğ
tİic
) {

132 
log_´
[
i
] = 
TİicTabËUts
::
LogGammaR©io
(
bË
, 
tİic
,

133 
wÜd_ids
, 
couÁs
) +

134 
log
(
tİic
->
g‘TabËCouÁ
());

136 
	glog_´
[
i
] = 
TİicTabËUts
::
LogGammaR©io
(
bË
, 
tİic


137 
wÜd_ids
, 
couÁs
) +

138 
log
(
tİic
->
g‘TabËCouÁ
() - 1);

140 
Tİic
* 
	gÃw_tİic
 = 
®l_tİics
.
g‘MubËTİic
(
tİics
);

141 
	glog
[
tİics
] = 
log
(
gamma
è+ 
TİicTabËUts
::
LogGammaR©io
(
bË
, 
Ãw_tİic


142 
wÜd_ids
, 
couÁs
);

146 
	g§m¶e_tİic
 = 
Uts
::
Sam¶eFromLogPr
(
log_´
);

147 
Tİic
* 
	gŞd_tİic
 = 
bË
->
g‘MubËTİic
();

148 
Tİic
* 
	gÃw_tİic
 = 
®l_tİics
.
g‘MubËTİic
(
§m¶e_tİic
);

150 ià(
	gŞd_tİic
 !ğ
Ãw_tİic
) {

151 
bË
->
£tTİic
(
Ãw_tİic
);

152 
	gTabËUts
::
Upd©eTİicFromTabË
(
bË
, 
wÜd_ids
, 
couÁs
, 1);

155 ià(
	g§m¶e_tİic
 =ğ
tİics
) {

156 
®l_tİics
.
»moveLa¡Tİic
();

164 
	gDocum’t
::
Docum’t
(
id
)

165 : 
id_
(
id
) {

168 
Docum’t
::~Document() {

169 
size
 = 
g‘TabËs
();

170 
	gi
 = 0; i < 
	gsize
; i++) {

171 ià(
	gbËs_
 !ğ
NULL
) {

172 
d–‘e
 
bËs_
[
i
];

177 
	gTabË
::
»moveTabË
(
pos
) {

178 
TabË
* 
bË
 = 
bËs_
[
pos
];

179 
as£¹
(
bË
->
g‘WÜdCouÁ
() == 0);

180 
as£¹
(
bË
->
g‘M­WÜdCouÁ
().
size
() == 0);

181 
Tİic
* 
	gtİic
 = 
bË
->
g‘MubËTİic
();

182 
	gtİic
->
šcTabËCouÁ
(-1);

183 
	gtİic
 = 
NULL
;

184 autØ
	g™
 = 
bËs_
.
begš
(è+ 
pos
;

185 
d–‘e
 *
	g™
;

186 *
	g™
 = 
NULL
;

187 
	gbËs_
.
”a£
(
™
)

194 
	gDocum’tUts
::
AÍhaScÜe
(
Docum’t
* 
docum’t
,

195 
®pha
) {

196 
	gbËs
 = 
docum’t
->
g‘TabËs
();

197 
	gwÜds
 = 
docum’t
->
g‘WÜds
();

198 
	gscÜe
 = 0.0;

199 
	gscÜe
 +ğ
bËs
 * 
log
(
®pha
) +

200 
g¦_sf_Êgamma
(
®pha
) -

201 
g¦_sf_Êgamma
(
wÜds
 + 
®pha
);

202 
	gi
 = 0; i < 
	gbËs
; i++) {

203 
TabË
* 
	gbË
 = 
docum’t
->
g‘MubËTabË
(
i
);

204 
	gscÜe
 +ğ
g¦_sf_Êgamma
(
bË
->
g‘WÜdCouÁ
());

206  
	gscÜe
;

209 
	gDocum’tUts
::
Com·ùTabËs
(
Docum’t
* 
docum’t
) {

210 
bËs
 = 
docum’t
->
g‘TabËs
();

211 
	gi
 = 
bËs
 - 1; i >=0 ; --i) {

212 ià(
	gdocum’t
->
g‘MubËTabË
(
i
)->
g‘WÜds
() == 0) {

213 
docum’t
->
»moveTabË
(
i
);

218 
	gDocum’tUts
::
Sam¶eTabËs
(
Docum’t
* 
docum’t
,

219 
boŞ
 
»move
,

220 
®pha
,

221 
gamma
) {

222 
	gwÜds
 = 
docum’t
->
g‘WÜds
();

224 
	gi
 = 0; i < 
	gwÜds
; i++) {

225 
WÜd
* 
	gwÜd
 = 
docum’t
->
g‘MubËWÜd
(
i
);

226 
Sam¶eTabËFÜWÜd
(
docum’t
, 
wÜd
, 
»move
, 
®pha
, 
gamma
);

230 
	gDocum’tUts
::
Sam¶eTabËFÜWÜd
(
Docum’t
* 
docum’t
,

231 
WÜd
* 
wÜd
,

232 
boŞ
 
»move
,

233 
®pha
,

234 
gamma
) {

235 ià(
	g»move
è
	gWÜdUts
::
Upd©eTabËFromWÜd
(
wÜd
, -1);

237 
	gbËs
 = 
docum’t
->
g‘TabËs
();

238 
	gveùÜ
<> 
log_´
(
bËs
 + 1, 
log
(0));

240 
AÎTİics
 
	g®l_tİics
 = AÎTİics.
G‘In¡ªû
();

241 
	gtİics
 = 
®l_tİics
.
g‘Tİics
();

242 
as£¹
(
tİics
 > 0);

244 
	gcÜpus_wÜd_no
 = 
®l_tİics
.
g‘MubËTİic
(0).
g‘CÜpusWÜdNo
();

245 
	gwÜd_id
 = 
wÜd
->
g‘Id
();

249 
	gveùÜ
<> 
log_´_tİic
(
tİics
 + 1 , 0.0);

252 
	gveùÜ
<> 
f
(
tİics
+1, 
log
(0));

253 
	gf_Ãw
 = 
log
(
gamma
 / 
cÜpus_wÜd_no
);

255 
	glog_´_tİic
[
tİics
] = 
f_Ãw
;

257 
	gtÙ®_bËs
 = 0;

258 
	gunÜd”ed_m­
<
	gTİic
*, > 
	gtİic_to_k
;

260 
	gk
 = 0; k < 
	gtİics
; 
	gi
++) {

261 
Tİic
* 
	gtİic
 = 
®l_tİics
.
g‘MubËTİic
(
k
);

262 
	gtİic_to_k
[
tİic
*] = 
k
;

263 
	gf
[
k
] = 
tİic
->
g‘LogWÜdPr
(
wÜd_id
);

264 
	gbË_couÁ
 = 
tİic
->
g‘TabËCouÁ
();

265 
	gtÙ®_bËs
 +ğ
bË_couÁ
;

266 
	glog_´_tİic
[
k
] = 
f
[k] + 
log
(
bË_couÁ
);

267 
	gf_Ãw
 = 
Uts
::
LogSum
(
f_Ãw
,

268 
f
[
k
] + 
log
(
bË_couÁ
)));

270 
	gf_Ãw
 = 
f_Ãw
 - 
log
(
tÙ®_bËs
 + 
gamma
);

271 
	gf
[
tİics
] = 
f_Ãw
;

273 
	gt
 = 0; < 
	gbËs
;++) {

274 
TabË
* 
	gbË
 = 
docum’t
->
g‘MubËTabË
(
t
);

275 
	gbË_wÜd_couÁ
 = 
bË
.
g‘WÜdCouÁ
();

276 
	glog_wÜd_couÁ
 = 
log
(
bË_wÜd_couÁ
);

278 
Tİic
* 
	gtİic
 = 
bË
->
g‘MubËTİic
();

279 
	gk
 = 
tİic_to_k
[
tİic
];

281 
	glog_´
[
t
] = 
log_wÜd_couÁ
 + 
f
[
k
];

284 
	glog_´
[
bËs
] = 
log
(
®pha
è+ 
f
[
tİics
];

286 
	g§m¶e_bË
 = 
Uts
::
Sam¶eFromLogPr
(
log_´
);

289 ià(
	g§m¶e_bË
 =ğ
bËs
) {

291 
docum’t
->
addNewTabË
();

292 
TabË
* 
	gÃw_bË
 = 
docum’t
->
g‘MubËTabË
(
§m¶e_bË
);

293 
	gwÜd
->
£tTabË
(
Ãw_bË
);

295 
	g§m¶e_tİic
 = 
Uts
::
Sam¶eFromLogPr
(
log_´_tİic
);

296 ià(
	g§m¶e_tİic
 =ğ
tİics
) {

298 
®l_tİics
.
addNewTİic
(
cÜpus_wÜd_no
);

302 
Tİic
* 
	gÃw_tİic
 = 
®l_tİics
.
g‘MubËTİic
(
§m¶e_tİic
);

303 
	gÃw_bË
->
£tTİic
(
Ãw_tİic
);

307 
TabË
* 
	gÃw_bË
 = 
docum’t
->
g‘MubËTabË
(
§m¶e_bË
);

308 
	gwÜd
->
£tTabË
(
Ãw_bË
);

312 
	gWÜdUts
::
Upd©eTabËFromWÜd
(
wÜd
, 1);

	@documnet.h

1 #iâdeà
DOCUMENT_H_


2 
	#DOCUMENT_H_


	)

4 
	~<veùÜ
>

5 
	~<unÜd”ed_m­
>

7 
	~"tİic.h
"

9 
usšg
 
Çme¥aû
 
	g¡d
;

11 
Çme¥aû
 
	ghdp
 {

13 
şass
 
	gTabË
;

16 şas 
	cWÜd
 {

17 
	gpublic
:

18 
WÜd
(
id
);

19 ~
WÜd
();

21 
g‘Id
(ècÚ¡ {  
	gid_
; }

22 
£tId
(cÚ¡ & 
id
è{ 
	gid_
 = id; }

24 
TabË
* 
g‘MubËTabË
(è{  
	gbË_
; }

25 
£tTabË
(
TabË
* 
bË
è{ 
	gbË_
 =able; }

29 
	g´iv©e
:

31 
id_
;

34 
TabË
* 
	gbË_
;

40 şas 
	cWÜdUts
 {

41 
	gpublic
:

44 
Upd©eTabËFromWÜd
(
WÜd
* 
wÜd
, 
upd©e
);

50 şas 
	cTabË
 {

51 
	gpublic
:

52 
TabË
();

53 
TabË
(
wÜd_couÁ
);

55 
g‘WÜdCouÁ
(ècÚ¡ {  
	gwÜd_couÁ_
; }

56 
£tWÜdCouÁ
(cÚ¡ & 
wÜd_couÁ
è{ 
	gwÜd_couÁ_
 = word_count; }

57 
šcWÜdCouÁ
(
v®
è{ 
	gwÜd_couÁ_
 += val; }

59 
Tİic
* 
g‘MuabËTİic
(è{  
	gtİic
; }

60 
£tTİic
(
Tİic
* 
tİic
è{ 
	gtİic_
 =opic; }

62 
g‘CouÁById
(
wÜd_id
);

63 
upd©eM­WÜdCouÁ
(
wÜd_id
, 
upd©e
);

65 
	gunÜd”ed_m­
<, >& 
g‘M­WÜdCouÁ
(ècÚ¡ {  
	gm­_wÜd_couÁ_
; }

66 
	g´iv©e
:

68 
wÜd_couÁ_
;

71 
	gunÜd”ed_m­
<, > 
	gm­_wÜd_couÁ_
;

74 
Tİic
* 
	gtİic_
;

79 şas 
	cTabËUts
 {

80 
	gpublic
:

82 
G‘WÜdsAndCouÁs
(
TabË
* 
bË
,

83 
veùÜ
<>& 
wÜd_ids
,

84 
veùÜ
<>& 
couÁs
);

88 
Upd©eTİicFromTabË
(
TabË
* 
bË
,

89 
wÜd_id
,

90 
upd©e
);

97 
Upd©eTİicFromTabË
(
TabË
* 
bË
,

98 
veùÜ
<>& 
wÜd_ids
,

99 
veùÜ
<>& 
couÁs
,

100 
upd©e
);

103 
Sam¶eTİicFÜTabË
(
TabË
* 
bË
);

108 şas 
	cDocum’t
 {

109 
	gpublic
:

110 
Docum’t
(
id
);

111 ~
Docum’t
();

113 
g‘WÜds
(è{  
	gwÜds_
.
size
(); }

114 
g‘TabËs
(è{  
	gbËs_
.
size
(); }

116 
addWÜd
(cÚ¡ 
WÜd
& 
wÜd
è{ 
	gwÜds_
.
push_back
(word); }

117 
WÜd
* 
g‘MubËWÜd
(
i
è{ 
	g»uŒn
 &(
	gwÜds_
[i]); }

118 
£tWÜds
(cÚ¡ 
veùÜ
<
WÜd
>& 
wÜds
) {

119 
	gwÜds_
 = 
wÜds
;

122 
addNewTabË
() {

123 
TabË
* 
	gÃw_bË
 = 
Ãw
 Table(0);

124 
	gbËs_
.
push_back
(
Ãw_bË
);

126 
»moveTabË
(
pos
);

128 
TabË
* 
g‘MubËTabË
(
i
è{  
	gbËs_
[i]; }

130 
g‘Id
(ècÚ¡ {  
	gid_
; }

131 
£tId
(cÚ¡ 
id
è{ 
	gid_
 = id; }

134 
	g´iv©e
:

136 
id_
;

139 
	gveùÜ
<
	gWÜd
> 
	gwÜds_
;

142 
	gveùÜ
<
	gTabË
*> 
	gbËs_
;

147 şas 
	cDocum’tUts
 {

148 
	gpublic
:

153 
Sam¶eTabËs
(
Docum’t
* 
docum’t
,

154 
boŞ
 
»move
,

155 
®pha
,

156 
gamma
);

162 
Sam¶eTabËFÜWÜd
(
Docum’t
* 
docum’t
,

163 
WÜd
* 
wÜd
,

164 
boŞ
 
»move
,

165 
®pha
,

166 
gamma
);

168 
Com·ùTabËs
(
Docum’t
* 
docum’t
);

171 
AÍhaScÜe
(
Docum’t
* 
docum’t
,

172 
®pha
);

	@test.cc

1 
	~<io¡»am
>

2 
	~<m©h.h
>

4 
	~"uts.h
"

6 
usšg
 
Çme¥aû
 
	g¡d
;

8 
	$maš
() {

9 
veùÜ
<> 
log_´
;

10 
log_´
.
	`push_back
(
	`log
(1));

11 
log_´
.
	`push_back
(
	`log
(0));

14 
¿nd_£ed
 = 1234l;

15 
hdp
::
Uts
::
	`In™RªdomNumb”G’
(
¿nd_£ed
);

22 
cout
 << 
hdp
::
Uts
::
	`LogSum
(
	`log
(0),†og(2)è<< 
’dl
;

23 
cout
 << 
	`log
(2è<< 
’dl
;

25 
cout
 << 1 / (1 * 2.0è<< 
’dl
;

26 
cout
 << 
	`exp
(
	`log
(0è* 2è<< 
’dl
;

29 
	}
}

	@topic.cc

1 
	~<m©h.h
>

2 
	~<as£¹.h
>

4 
	~"uts.h
"

5 
	~"tİic.h
"

11 
	gTİic
::
	$Tİic
(
cÜpus_wÜd_no
)

12 : 
	`cÜpus_wÜd_no_
(
cÜpus_wÜd_no
),

13 
	`bË_couÁ_
(0),

14 
	$wÜd_couÁs_
(
cÜpus_wÜd_no
, 0) {

15 
AÎTİics
 
®l_tİics
 = AÎTİics::
	`G‘In¡ªû
();

16 
‘a
 = 
®l_tİics
.
	`g‘E
();

17 
lgam_w_‘a
 = 
	`g¦_sf_Êgamma
(
‘a
);

19 
wÜd_couÁs_
 = 
	`veùÜ
(
cÜpus_wÜd_no
, 0);

20 
lgam_wÜd_‘a_
 = 
	`veùÜ
(
cÜpus_wÜd_no
, 
lgam_w_‘a
);

22 
log_w_´
 = 
	`log
(1.0 / 
cÜpus_wÜd_no
);

23 
log_wÜd_´_
 = 
	`veùÜ
(
cÜpus_wÜd_no
, 
log_w_´
);

25 
	}
}

27 
	gTİic
::
	$upd©eWÜdCouÁs
(
wÜd_id
, 
upd©e
) {

28 
wÜd_couÁs_
[
wÜd_id
] +ğ
upd©e
;

30 
‘a
 = 
AÎAuthÜ
::
	`G‘In¡ªû
().
	`g‘E
();

31 
wÜd_couÁ
 = 
wÜd_couÁs_
[
wÜd_id
];

33 
lgam_wÜd_‘a_
[
wÜd_id
] = 
	`g¦_sf_Êgamma
(
wÜd_couÁ
 + 
‘a
);

34 
log_wÜd_´_
[
wÜd_id
] = 
	`log
(
wÜd_couÁ
è-log(wÜd_couÁ + 
‘a
 * 
cÜpus_wÜd_no_
 );

35 
	}
}

37 
	gTİic
::
	$g‘TİicWÜds
() const {

38 
sum
 = 0;

39 autØ
couÁ
 : 
wÜd_couÁs_
) {

40 
sum
 +ğ
couÁ
;

43  
sum
;

44 
	}
}

49 
	gAÎTİics
::~
	$AÎTİics
() {

50 
size
 = 
tİic_±rs_
.
	`size
();

51 
i
 = 0; i < 
size
; i++) {

52 ià(
tİic_±rs_
[
i
] !ğ
NULL
) {

53 
d–‘e
 
tİic_±rs_
[
i
];

56 
	}
}

58 
	gAÎTİics
::
AÎTİics
& 
	$G‘In¡ªû
() {

59 
AÎTİics
 
š¡ªû
;

60  
š¡ªû
;

61 
	}
}

63 
	gAÎTİics
::
	$addNewTİic
(
cÜpus_wÜd_no
) {

64 
Tİic
* 
tİic
 = 
Ãw
 
	`Tİic
(
cÜpus_wÜd_no
);

65 
tİic_±rs_
.
	`push_back
(
tİic
);

66 
	}
}

68 
	gAÎTİics
::
	$»moveTİic
(
Tİic
* 
tİic
) {

69 
	`»moveFromVec
(
tİic_±rs_
, 
tİic
);

70 
	}
}

72 
	gAÎTİics
::
	$»moveTİic
(
pos
) {

73 autØ
™
 = 
tİic_±rs_
.
	`begš
(è+ 
pos
;

74 
Tİic
* 
tİic
 = *
™
;

75 
	`as£¹
(
tİic
->
	`g‘TabËCouÁ
() == 0);

77 
d–‘e
 *
™
;

78 
tİic
 = 
NULL
;

79 *
™
 = 
NULL
;

80 
tİic_±rs_
.
	`”a£
(
™
);

81 
	}
}

84 
	gAÎTİics
::
	$»moveLa¡Tİic
() {

85 
size
 = 
tİic_±rs_
.
	`size
();

86 
d–‘e
 
tİic_±rs_
[
size
];

87 
tİic_±rs_
[
size
] = 
NULL
;

88 
tİic_±rs_
.
	`»size
(
size
 - 1);

89 
	}
}

91 
	gAÎTOpics
::
	$com·ùTİics
() {

92 
size
 = 
tİic_±rs_
.
	`size
();

93 
i
 = 
size
 - 1; i >=0; --i) {

94 ià(
tİic_±rs_
[
i
]->
	`g‘TabËCouÁ
() == 0) {

95 
	`»moveTİic
(
i
);

98 
	}
}

105 
	gTİicTabËUts
::
LogGammaR©io
(
TabË
* 
bË
,

106 
Tİic
* 
tİic
,

107 
vecÙr
<>& 
wÜd_ids
,

108 
vecÙr
<>& 
couÁs
) {

109 
	glog_gamma_¿tio
 = 0.0;

110 
Tİic
* 
	gŞd_tİic
 = 
bË
->
g‘MubËTİic
();

112 
	g‘a
 = 
AÎTİics
::
G‘In¡ªû
().
g‘E
();

113 
	gtİic_wÜds
 = 
tİic
->
g‘TİicWÜds
();

114 
	gbË_wÜds
 = 
bË
->
g‘WÜdCouÁ
();

115 
	gcÜpus_wÜd_no
 = 
tİic
->
g‘CÜpusWÜdNo
();

119 ià(
	gŞd_tİic
 =ğ
tİic
) {

120 
log_gamma_¿tio
 +ğ
g¦_sf_Êgamma
(
cÜpus_wÜd_no
 * 
‘a
 + 
tİic_wÜds
 - 
bË_wÜds
) -

121 
g¦_sf_Êgamma
(
cÜpus_wÜd_no
 * 
‘a
 + 
tİic_wÜds
)

123 
i
 = 0; 
	gi
 < ()
	gwÜd_ids
.
size
(); i++) {

124 
	gwÜd_id
 = 
wÜd_ids
[
i
];

125 
	gwÜd_couÁ
 = 
tİic
->
g‘WÜdCouÁ
(
wÜd_id
);

126 
	glog_gamma_¿tio
 +ğ
tİic
->
g‘LgamWÜdE
(
wÜd_id
) -

127 
g¦_sf_Êgamma
(
wÜd_couÁ
 + 
‘a
 - 
couÁs
[
i
]);

130 
	glog_gamma_¿tio
 +ğ
g¦_sf_Êgamma
(
cÜpus_wÜd_no
 * 
‘a
 + 
tİic_wÜds
) -

131 
g¦_sf_Êgamma
(
cÜpus_wÜd_no
 * 
‘a
 + 
tİic_wÜds
 + 
bË_wÜds
)

133 
i
 = 0; 
	gi
 < ()
	gwÜd_ids
.
size
(); i++) {

134 
	gwÜd_id
 = 
wÜd_ids
[
i
];

135 
	gwÜd_couÁ
 = 
tİic
->
g‘WÜdCouÁ
(
wÜd_id
);

136 
	glog_gamma_¿tio
 +ğ
g¦_sf_Êgamma
(
wÜd_couÁ
 + 
‘a
 + 
couÁs
[
i
]) -

137 
tİic
->
g‘LgamWÜdE
(
wÜd_id
);

141  
	glog_gamma_¿tio
;

	@topic.h

1 #iâdeà
TOPIC_H_


2 
	#TOPIC_H_


	)

4 
	~<veùÜ
>

5 
	~<g¦/g¦_sf.h
>

7 
usšg
 
Çme¥aû
 
	g¡d
;

10 
Çme¥aû
 
	ghdp
 {

12 
şass
 
	gAÎTİics
;

17 şas 
	cTİic
 {

18 
	gpublic
:

19 
Tİic
(
cÜpus_wÜd_no
, 
AÎTİics
* 
®l_tİics_
);

21 
g‘CÜpusWÜdNo
(ècÚ¡ {  
	gcÜpus_wÜd_no_
; }

22 
£tCÜpusWÜdNO
(
cÜpus_wÜd_no
è{ 
	gcÜpus_wÜd_no_
 = corpus_word_no; }

24 
g‘TabËCouÁ
(ècÚ¡ {  
	gbË_couÁ_
; }

25 
£tTabËCouÁ
(
bË_couÁ
è{ 
	gbË_couÁ
 = 
bË_couÁ_
; }

26 
šcTabËCouÁ
(
v®
è{ 
	gbË_couÁ_
 += val; }

28 
upd©eWÜdCouÁs
(
wÜd_id
, 
upd©e
);

29 
g‘WÜdCouÁ
(
wÜd_id
ècÚ¡ {  
	gwÜd_couÁs_
[word_id]; }

31 
g‘LgamWÜdE
(
wÜd_id
ècÚ¡ {  
	glgam_wÜd_‘a_
[word_id]; }

32 
g‘LogWÜdPr
(
wÜd_id
ècÚ¡ {  
	glog_wÜd_´_
[word_id]; }

34 
g‘TİicWÜds
() const;

35 
	g´iv©e
:

37 
cÜpus_wÜd_no_
;

40 
	gbË_couÁ_
;

43 
	gvecÙr
<> 
	gwÜd_couÁs_
;

46 
	gveùÜ
<> 
	glgam_wÜd_‘a_
;

49 
	gveùÜ
<> 
	glog_wÜd_´_
;

57 şas 
	cAÎTİics
 {

58 
	gpublic
:

59 ~
AÎTİics
();

62 
	gAÎTİics
& 
G‘In¡ªû
();

64 
g‘Tİics
(ècÚ¡ {  
	gtİic_±rs_
.
size
(); }

66 
addNewTİic
(
cÜpus_wÜd_no
);

67 
»moveTİic
(
Tİic
* 
tİic
);

68 
»moveTİic
(
pos
);

69 
»moveLa¡Tİic
();

70 
com·ùTİics
();

72 
Tİic
* 
g‘MubËTİic
(
i
) {

73  
	gtİic_±rs_
[
i
];

76 
g‘E
(ècÚ¡ {  
	g‘a_
; }

77 
£tE
(cÚ¡ & 
‘a
è{ 
	g‘a_
 =ƒta; }

79 
	g´iv©e
:

81 
veùÜ
<
Tİic
*> 
tİic_±rs_
;

84 
	g‘a_
;

87 
AÎTİics
() { }

89 
AÎTİics
(cÚ¡ AÎTİics& 
äom
);

90 
	gAÎTİics
& 
	gİ”©Ü
=(cÚ¡ 
AÎTİics
& 
äom
);

95 şas 
	cTİicTabËUts
 {

96 
	gpublic
:

102 
LogGammaR©io
(
TabË
* 
bË
,

103 
Tİic
* 
tİic
,

104 
vecÙr
<>& 
wÜd_ids
,

105 
vecÙr
<>& 
couÁs
);

	@utils.cc

16 
	~<as£¹.h
>

17 
	~<m©h.h
>

18 
	~<time.h
>

19 
	~<g¦/g¦_sf.h
>

21 
	~<io¡»am
>

23 
	~"uts.h
"

25 
Çme¥aû
 
	ghdp
 {

31 
g¦_ºg
* 
	gUts
::
RANDNUMGEN
 = 
NULL
;

33 
	gUts
::
Sum
(cÚ¡ 
veùÜ
<>& 
v
) {

34 
sum
 = 0;

35 
	gsize
 = 
v
.
size
();

36 
	gi
 = 0; i < 
	gsize
; i++) {

37 
	gsum
 +ğ
v
[
i
];

39  
	gsum
;

42 
	gUts
::
LogSum
(
log_a
, 
log_b
) {

43 ià(
	glog_a
 < 
	glog_b
) {

44 (
	glog_b
 + 
log
(1 + 
exp
(
log_a
 - 
log_b
)));

46 (
	glog_a
 + 
log
(1 + 
exp
(
log_b
 - 
log_a
)));

50 
	gUts
::
Sam¶eFromLogPr
(cÚ¡ 
veùÜ
<>& 
log_´
) {

51 
as£¹
(
log_´
.
size
() > 0);

53 
	glog_sum
 = 
log_´
[0];

54 
	gËv–s
 = 
log_´
.
size
();

57 
	gi
 = 1; i < 
	gËv–s
; i++) {

58 
	glog_sum
 = 
LogSum
(
log_sum
, 
log_´
[
i
]);

62 
	g¿nd_no
 = 
RªdNo
();

64 
	glog_exp
 = 
exp
(
log_´
[0] - 
log_sum
);

65 
	g»suÉ
 = 0;

66 
	g¿nd_no
 >ğ
log_exp
) {

67 
»suÉ
++;

68 
	glog_exp
 +ğ
exp
(
log_´
[
»suÉ
] - 
log_sum
);

71  
	g»suÉ
;

74 
	gUts
::
In™RªdomNumb”G’
(
ºg_£ed
) {

75 ià(
RANDNUMGEN
 !ğ
NULL
) ;

77 
	gRANDNUMGEN
 = 
g¦_ºg_®loc
(
g¦_ºg_us
);

78 
	gcout
 << "Rªdom s“d = " << 
	gºg_£ed
 << 
	g’dl
;

79 
g¦_ºg_£t
(
RANDNUMGEN
, 
ºg_£ed
);

82 
	gUts
::
Shufæe
(
g¦_³rmutiÚ
* 
³rmutiÚ
, 
size
) {

83 
as£¹
(
RANDNUMGEN
 !ğ
NULL
);

84 
g¦_¿n_shufæe
(
RANDNUMGEN
, 
³rmutiÚ
->
d©a
, 
size
, (
size_t
));

87 
	gUts
::
RªdGauss
(
m—n
, 
¡dev
) {

88 
as£¹
(
RANDNUMGEN
 !ğ
NULL
);

89 
	ggauss
 = 
g¦_¿n_gaussŸn_¿tio_m‘hod
(
RANDNUMGEN
, 
¡dev
è+ 
	gm—n
;

90 (
	ggauss
);

93 
	gUts
::
RªdNo
() {

94 
as£¹
(
RANDNUMGEN
 !ğ
NULL
);

95  
g¦_ºg_unifÜm
(
RANDNUMGEN
);

	@utils.h

16 #iâdeà
UTILS_H_


17 
	#UTILS_H_


	)

19 
	~<g¦/g¦_³rmutiÚ.h
>

20 
	~<g¦/g¦_¿ndi¡.h
>

22 
	~<veùÜ
>

23 
	~<®gÜ™hm
>

25 
usšg
 
Çme¥aû
 
	g¡d
;

27 
Çme¥aû
 
	ghdp
 {

31 
	g‹m¶©e
<
ty³Çme
 
	gT
>

32 
»moveFromVec
(
veùÜ
<
T
>& 
v
, T 
rg‘
) {

33 autØ
	gfound
 = 
fšd
(
v
.
begš
(), v.
’d
(), 
rg‘
);

34 ià(
	gfound
 =ğ
v
.
’d
()) {

37 
v
.
”a£
(
found
);

41 
	g‹m¶©e
<
ty³Çme
 
	gT
>

42 
»moveFromVec
(
veùÜ
<
T
*>& 
v
, T* 
rg‘
) {

43 autØ
	gfound
 = 
fšd
(
v
.
begš
(), v.
’d
(), 
rg‘
);

44 ià(
	gfound
 =ğ
v
.
’d
()) {

48 ià(*
found
 !ğ
NULL
) {

49 
d–‘e
 *
found
;

50 *
	gfound
 = 
NULL
;

53 
	gv
.
”a£
(
found
);

61 şas 
	cUts
 {

62 
	gpublic
:

64 
Sum
(cÚ¡ 
veùÜ
<>& 
v
);

71 
LogSum
(
log_a
, 
log_b
);

79 
Sam¶eFromLogPr
(cÚ¡ 
veùÜ
<>& 
log_´
);

82 
Shufæe
(
g¦_³rmutiÚ
* 
³rmutiÚ
, 
size
);

86 
In™RªdomNumb”G’
(
ºg_£ed
);

89 
RªdGauss
(
m—n
, 
¡dev
);

92 
RªdNo
();

94 
	g´iv©e
:

95 
g¦_ºg
* 
RANDNUMGEN
;

	@
1
.
0
9
84
corpus.cc
corpus.h
document.cc
documnet.h
test.cc
topic.cc
topic.h
utils.cc
utils.h
